# Backend Reference Changelog

–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ Backend API –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É—é—Ç—Å—è –∑–¥–µ—Å—å.

---

## [INITIAL] - 2024-12-30

### ‚úÖ –°–æ–∑–¥–∞–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ Backend Reference

**–§–∞–π–ª—ã:**
- `index.ts` - –ü–æ–ª–Ω—ã–π –∫–æ–¥ backend —Å–µ—Ä–≤–µ—Ä–∞
- `database.ts` - –°—Ö–µ–º–∞ SQLite –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- `API_REFERENCE.md` - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≤—Å–µ—Ö endpoints
- `README.md` - –ü—Ä–∞–≤–∏–ª–∞ —Ä–∞–±–æ—Ç—ã —Å backend reference
- `CHANGELOG.md` - –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

### üìä Endpoints

#### Public (–±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏):
- `GET /api/stats/public` - –ü—É–±–ª–∏—á–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- `GET /api/drops/recent` - –ü–æ—Å–ª–µ–¥–Ω–∏–µ 20 –¥—Ä–æ–ø–æ–≤ –¥–ª—è Live Feed
- `GET /api/cases/:id` - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–µ–π—Å–µ

#### Auth:
- `POST /api/auth/session` - –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ SmartShell

#### User (—Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π):
- `GET /api/profile` - –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è + –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∫–µ–π—Å—ã
- `POST /api/user/tradelink` - –û–±–Ω–æ–≤–∏—Ç—å Trade Link
- `GET /api/user/history` - –ò—Å—Ç–æ—Ä–∏—è –æ—Ç–∫—Ä—ã—Ç–∏–π (50 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö)

#### Cases:
- `POST /api/cases/open` - –û—Ç–∫—Ä—ã—Ç—å –∫–µ–π—Å (winner –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ)

#### Inventory:
- `GET /api/inventory` - –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `POST /api/inventory/sell` - –ü—Ä–æ–¥–∞—Ç—å –ø—Ä–µ–¥–º–µ—Ç –∑–∞ –±–∞–ª–∞–Ω—Å
- `POST /api/inventory/claim` - –ü–æ–ª—É—á–∏—Ç—å –ø—Ä–µ–¥–º–µ—Ç (–¥–µ–Ω—å–≥–∏ –∞–≤—Ç–æ, —Å–∫–∏–Ω—ã ‚Üí –∑–∞—è–≤–∫–∞)

#### Admin:
- `GET /api/admin/items` - –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤
- `POST /api/admin/items` - –°–æ–∑–¥–∞—Ç—å –ø—Ä–µ–¥–º–µ—Ç
- `DELETE /api/admin/items/:id` - –£–¥–∞–ª–∏—Ç—å –ø—Ä–µ–¥–º–µ—Ç
- `GET /api/admin/cases` - –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–µ–π—Å–æ–≤ + contents
- `POST /api/admin/cases` - –°–æ–∑–¥–∞—Ç—å –∫–µ–π—Å
- `PUT /api/admin/cases/:id` - –û–±–Ω–æ–≤–∏—Ç—å –∫–µ–π—Å
- `DELETE /api/admin/cases/:id` - –£–¥–∞–ª–∏—Ç—å –∫–µ–π—Å
- `GET /api/admin/requests` - –°–ø–∏—Å–æ–∫ –∑–∞—è–≤–æ–∫ –Ω–∞ –≤—ã–≤–æ–¥
- `POST /api/admin/requests/:id/approve` - –û–¥–æ–±—Ä–∏—Ç—å –∑–∞—è–≤–∫—É
- `POST /api/admin/requests/:id/deny` - –û—Ç–∫–ª–æ–Ω–∏—Ç—å –∑–∞—è–≤–∫—É
- `POST /api/admin/requests/:id/return` - –í–µ—Ä–Ω—É—Ç—å –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å

### üóÑ Database Tables

1. **sessions** - –ê–∫—Ç–∏–≤–Ω—ã–µ —Å–µ—Å—Å–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
2. **user_settings** - Trade Link, —É—Ä–æ–≤–µ–Ω—å, XP
3. **items** - –í—Å–µ –ø—Ä–µ–¥–º–µ—Ç—ã (skin/physical/money)
4. **cases** - –ö–µ–π—Å—ã (daily/monthly/event)
5. **case_items** - –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–µ–π—Å–æ–≤ —Å –≤–µ—Å–∞–º–∏
6. **case_claims** - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ –æ—Ç–∫—Ä—ã—Ç–∏–µ (daily/monthly)
7. **spins** - –ò—Å—Ç–æ—Ä–∏—è –æ—Ç–∫—Ä—ã—Ç–∏–π (–¥–ª—è Live Feed)
8. **inventory** - –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
9. **requests** - –ó–∞—è–≤–∫–∏ –Ω–∞ –≤—ã–≤–æ–¥ —Å–∫–∏–Ω–æ–≤/—Ñ–∏–∑ —Ç–æ–≤–∞—Ä–æ–≤

### üîß Integrations

- **SmartShell API** - –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è, –±–∞–ª–∞–Ω—Å, –¥–µ–ø–æ–∑–∏—Ç—ã
- **Riga Timezone** - –í—Å–µ daily/monthly —Ä–∞—Å—á–µ—Ç—ã –≤ —á–∞—Å–æ–≤–æ–º –ø–æ—è—Å–µ `Europe/Riga`

### üéØ Key Features

- **Weighted Random** –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è winner –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –∫–µ–π—Å–∞
- **Auto-claim** –¥–ª—è –¥–µ–Ω–µ–≥ (–ø—Ä—è–º–æ –Ω–∞ SmartShell –±–∞–ª–∞–Ω—Å)
- **Request System** –¥–ª—è —Å–∫–∏–Ω–æ–≤/—Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö —Ç–æ–≤–∞—Ä–æ–≤
- **Daily/Monthly Progress** –Ω–∞ –æ—Å–Ω–æ–≤–µ SmartShell –¥–µ–ø–æ–∑–∏—Ç–æ–≤
- **Live Feed** - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ 20 –¥—Ä–æ–ø–æ–≤ –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤

---

## –§–æ—Ä–º–∞—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π

–ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ backend –∏—Å–ø–æ–ª—å–∑—É–π —ç—Ç–æ—Ç —Ñ–æ—Ä–º–∞—Ç:

### [DATE] - –ù–∞–∑–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

**Added:**
- –ù–æ–≤—ã–π endpoint `GET /api/...`
- –ù–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ `table_name`

**Changed:**
- –ü–æ–ª–µ `old_name` ‚Üí `new_name` –≤ endpoint `/api/...`
- –õ–æ–≥–∏–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ `feature_name`

**Fixed:**
- –ë–∞–≥ —Å `description`

**Removed:**
- –£–¥–∞–ª–µ–Ω endpoint `DELETE /api/...` (deprecated)

---

## üîÆ Planned Changes

–ó–¥–µ—Å—å –±—É–¥—É—Ç –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å—Å—è –ø–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:

- [ ] –î–æ–±–∞–≤–∏—Ç—å endpoint `/api/leaderboard` - —Ç–æ–ø –∏–≥—Ä–æ–∫–æ–≤ –ø–æ XP
- [ ] –î–æ–±–∞–≤–∏—Ç—å webhook –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∞–¥–º–∏–Ω–∞ –æ –Ω–æ–≤—ã—Ö –∑–∞—è–≤–∫–∞—Ö
- [ ] –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `notification_sent` –≤ —Ç–∞–±–ª–∏—Ü—É `requests`
