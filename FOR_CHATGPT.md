# ü§ñ CyberHub - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è ChatGPT/Backend —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞

## üìã –û –ø—Ä–æ–µ–∫—Ç–µ

**CyberHub** - –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –∫–µ–π—Å–æ–≤ –¥–ª—è –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã—Ö –∫–ª—É–±–æ–≤ —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π **SmartShell API**.

### –î–≤–∞ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:

1. **–ö–ª–∏–µ–Ω—Ç—Å–∫–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** (Desktop Windows .exe)
   - React + TypeScript + Tailwind
   - –ë—É–¥–µ—Ç –∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤ .exe —á–µ—Ä–µ–∑ Electron/Tauri
   - –î–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã—Ö –∫–ª—É–±–æ–≤

2. **–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å** (Web —Å–∞–π—Ç –Ω–∞ –¥–æ–º–µ–Ω–µ)
   - React + TypeScript + Tailwind
   - –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∞
   - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–µ–π—Å–∞–º–∏, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏, –∑–∞—è–≤–∫–∞–º–∏

---

## üéØ –ó–∞–¥–∞—á–∞ –¥–ª—è ChatGPT

–°–æ–∑–¥–∞—Ç—å **Backend API** –¥–ª—è –æ–±–æ–∏—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π **SmartShell API**.

---

## üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ (—á—Ç–æ —É–∂–µ –≥–æ—Ç–æ–≤–æ)

### –ö–ª–∏–µ–Ω—Ç—Å–∫–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

**–ì–ª–∞–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- `/src/app/ClientApp.tsx` - –æ—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- `/src/app/components/CasesPage.tsx` - –≥–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –∫–µ–π—Å–∞–º–∏
- `/src/app/components/CaseOpenPage.tsx` - –æ—Ç–∫—Ä—ã—Ç–∏–µ –∫–µ–π—Å–∞ (—Ä—É–ª–µ—Ç–∫–∞)
- `/src/app/components/WinPage.tsx` - —ç–∫—Ä–∞–Ω –≤—ã–∏–≥—Ä—ã—à–∞
- `/src/app/components/InventoryPage.tsx` - –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å –∏–≥—Ä–æ–∫–∞
- `/src/app/components/PlayerProfile.tsx` - –ø—Ä–æ—Ñ–∏–ª—å –∏–≥—Ä–æ–∫–∞

**–ö–æ–Ω—Ç–µ–∫—Å—Ç –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏:**
- `/src/app/contexts/LanguageContext.tsx` - EN/RU/LV

### –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å

**–ì–ª–∞–≤–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã:**
- `/src/app/admin/pages/LoginPage.tsx` - –≤—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É
- `/src/app/admin/pages/DashboardPage.tsx` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- `/src/app/admin/pages/ItemsPage.tsx` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–∞–º–∏
- `/src/app/admin/pages/CasesPage.tsx` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–µ–π—Å–∞–º–∏
- `/src/app/admin/pages/RequestsPage.tsx` - –∑–∞—è–≤–∫–∏ –Ω–∞ –≤—ã–¥–∞—á—É –ø—Ä–∏–∑–æ–≤
- `/src/app/admin/pages/ProblemQueuePage.tsx` - –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ –∑–∞—è–≤–∫–∏
- `/src/app/admin/pages/UsersPage.tsx` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∞–º–∏
- `/src/app/admin/pages/LogsPage.tsx` - –ª–æ–≥–∏ –¥–µ–π—Å—Ç–≤–∏–π

**–ö–æ–Ω—Ç–µ–∫—Å—Ç –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏:**
- `/src/app/admin/contexts/AdminLanguageContext.tsx` - EN/RU/LV

---

## üîß –ß—Ç–æ –Ω—É–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å (Backend)

### 1. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

#### –¢–∞–±–ª–∏—Ü–∞ `users` (–∫–ª–∏–µ–Ω—Ç—ã)
```sql
id              UUID PRIMARY KEY
smartshell_id   VARCHAR UNIQUE    -- ID –∏–∑ SmartShell
username        VARCHAR
balance         DECIMAL(10, 2)    -- –ë–∞–ª–∞–Ω—Å SmartShell
total_spent     DECIMAL(10, 2)
cases_opened    INT
created_at      TIMESTAMP
last_active     TIMESTAMP
```

#### –¢–∞–±–ª–∏—Ü–∞ `items` (–ø—Ä–µ–¥–º–µ—Ç—ã –≤ –∫–µ–π—Å–∞—Ö)
```sql
id              UUID PRIMARY KEY
name_en         VARCHAR
name_ru         VARCHAR
name_lv         VARCHAR
description_en  TEXT
description_ru  TEXT
description_lv  TEXT
image_url       VARCHAR
type            ENUM('physical', 'balance', 'virtual')
rarity          ENUM('common', 'rare', 'epic', 'legendary', 'mythic')
stock           INT               -- NULL –¥–ª—è balance (unlimited)
low_stock       INT
status          ENUM('active', 'hidden')
created_at      TIMESTAMP
```

#### –¢–∞–±–ª–∏—Ü–∞ `cases` (–∫–µ–π—Å—ã)
```sql
id              UUID PRIMARY KEY
name_en         VARCHAR
name_ru         VARCHAR
name_lv         VARCHAR
image_url       VARCHAR
type            ENUM('daily', 'monthly')
price           DECIMAL(10, 2)
deposit_min     DECIMAL(10, 2)    -- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –¥–µ–ø–æ–∑–∏—Ç –¥–ª—è –¥–æ—Å—Ç—É–ø–∞
status          ENUM('draft', 'active', 'hidden')
created_at      TIMESTAMP
version         INT               -- –í–µ—Ä—Å–∏–æ–Ω–Ω–æ—Å—Ç—å
```

#### –¢–∞–±–ª–∏—Ü–∞ `case_items` (—Å–æ—Å—Ç–∞–≤ –∫–µ–π—Å–∞ - many-to-many)
```sql
id              UUID PRIMARY KEY
case_id         UUID REFERENCES cases(id)
item_id         UUID REFERENCES items(id)
drop_chance     DECIMAL(5, 2)     -- –í –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö (0.01 - 100.00)
```

#### –¢–∞–±–ª–∏—Ü–∞ `user_inventory` (–∏–Ω–≤–µ–Ω—Ç–∞—Ä—å –∏–≥—Ä–æ–∫–∞)
```sql
id              UUID PRIMARY KEY
user_id         UUID REFERENCES users(id)
item_id         UUID REFERENCES items(id)
won_from_case   UUID REFERENCES cases(id)
status          ENUM('in_inventory', 'claimed', 'returned')
won_at          TIMESTAMP
claimed_at      TIMESTAMP
```

#### –¢–∞–±–ª–∏—Ü–∞ `prize_requests` (–∑–∞—è–≤–∫–∏ –Ω–∞ –≤—ã–¥–∞—á—É)
```sql
id              UUID PRIMARY KEY
user_id         UUID REFERENCES users(id)
inventory_id    UUID REFERENCES user_inventory(id)
item_id         UUID REFERENCES items(id)
phone           VARCHAR
nickname        VARCHAR
comment         TEXT
status          ENUM('pending', 'approved', 'denied', 'returned', 'expired')
admin_comment   TEXT
processed_by    UUID REFERENCES admin_users(id)
processed_at    TIMESTAMP
created_at      TIMESTAMP
```

#### –¢–∞–±–ª–∏—Ü–∞ `admin_users` (–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã)
```sql
id              UUID PRIMARY KEY
username        VARCHAR UNIQUE
password_hash   VARCHAR
email           VARCHAR
full_name       VARCHAR
role            ENUM('owner', 'administrator', 'moderator')
status          ENUM('active', 'blocked')
blocked_until   TIMESTAMP
created_at      TIMESTAMP
last_active     TIMESTAMP
```

#### –¢–∞–±–ª–∏—Ü–∞ `audit_logs` (–ª–æ–≥–∏ –¥–µ–π—Å—Ç–≤–∏–π)
```sql
id              UUID PRIMARY KEY
admin_id        UUID REFERENCES admin_users(id)
action          VARCHAR           -- "created_item", "opened_case", etc.
entity_type     VARCHAR           -- "item", "case", "request"
entity_id       UUID
details         JSONB             -- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
ip_address      VARCHAR
created_at      TIMESTAMP
```

---

### 2. API Endpoints

#### **–ö–ª–∏–µ–Ω—Ç—Å–∫–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**

**–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:**
```
POST /api/auth/smartshell
Body: { smartshell_token: string }
Response: { user: User, token: string }
```

**–ö–µ–π—Å—ã:**
```
GET /api/cases
Response: { cases: Case[] }

GET /api/cases/:id
Response: { case: Case, items: Item[] }

POST /api/cases/:id/open
Headers: { Authorization: "Bearer <token>" }
Response: { won_item: Item, animation_sequence: number[] }
```

**–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å:**
```
GET /api/inventory
Headers: { Authorization: "Bearer <token>" }
Response: { items: InventoryItem[] }

POST /api/inventory/:id/claim
Headers: { Authorization: "Bearer <token>" }
Body: { phone: string, nickname: string, comment: string }
Response: { request_id: UUID }
```

**–ü—Ä–æ—Ñ–∏–ª—å:**
```
GET /api/profile
Headers: { Authorization: "Bearer <token>" }
Response: { user: User, stats: Stats }

GET /api/profile/:user_id
Response: { user: PublicUser, recent_wins: Win[] }
```

**–õ–µ–Ω—Ç–∞ –¥—Ä–æ–ø–æ–≤:**
```
GET /api/drops/live
Response: { drops: Drop[] }  // –ü–æ—Å–ª–µ–¥–Ω–∏–µ 50 –≤—ã–∏–≥—Ä—ã—à–µ–π
```

#### **–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å**

**–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:**
```
POST /api/admin/auth/login
Body: { username: string, password: string }
Response: { admin: AdminUser, token: string }

POST /api/admin/auth/change-password
Headers: { Authorization: "Bearer <admin-token>" }
Body: { old_password: string, new_password: string }
```

**–ü—Ä–µ–¥–º–µ—Ç—ã:**
```
GET /api/admin/items
GET /api/admin/items/:id
POST /api/admin/items
PUT /api/admin/items/:id
DELETE /api/admin/items/:id
```

**–ö–µ–π—Å—ã:**
```
GET /api/admin/cases
GET /api/admin/cases/:id
POST /api/admin/cases
PUT /api/admin/cases/:id
DELETE /api/admin/cases/:id
PUT /api/admin/cases/:id/publish
```

**–ó–∞—è–≤–∫–∏:**
```
GET /api/admin/requests
GET /api/admin/requests/:id
PUT /api/admin/requests/:id/approve
PUT /api/admin/requests/:id/deny
PUT /api/admin/requests/:id/return
```

**–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (–∞–¥–º–∏–Ω—ã):**
```
GET /api/admin/users
POST /api/admin/users
PUT /api/admin/users/:id
DELETE /api/admin/users/:id
PUT /api/admin/users/:id/block
```

**–õ–æ–≥–∏:**
```
GET /api/admin/logs
Query: ?start_date=...&end_date=...&admin_id=...&action=...
```

**–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**
```
GET /api/admin/stats/dashboard
Response: {
  cases_opened_today: number,
  cases_opened_week: number,
  cases_opened_month: number,
  pending_requests: number,
  problem_queue: number,
  low_stock_items: number,
  revenue_today: number,
  revenue_week: number,
  revenue_month: number
}
```

---

### 3. SmartShell API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

#### –ß—Ç–æ –Ω—É–∂–Ω–æ –æ—Ç SmartShell API:

**–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:**
- –ü–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω/ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ SmartShell
- –ü–æ–ª—É—á–∏—Ç—å –±–∞–ª–∞–Ω—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–°–ø–∏—Å–∞–Ω–∏–µ —Å—Ä–µ–¥—Å—Ç–≤:**
- –ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –∫–µ–π—Å–∞ —Å–ø–∏—Å–∞—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å –∫–µ–π—Å–∞ —Å –±–∞–ª–∞–Ω—Å–∞ SmartShell

**–ù–∞—á–∏—Å–ª–µ–Ω–∏–µ —Å—Ä–µ–¥—Å—Ç–≤:**
- –ï—Å–ª–∏ –≤—ã–∏–≥—Ä–∞–Ω "Balance Bonus", –Ω–∞—á–∏—Å–ª–∏—Ç—å –Ω–∞ SmartShell –±–∞–ª–∞–Ω—Å

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–µ–ø–æ–∑–∏—Ç–∞:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–Ω—ë—Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –¥–µ–ø–æ–∑–∏—Ç –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–µ–π—Å—É

**Webhook (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):**
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–∏ –±–∞–ª–∞–Ω—Å–∞
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

---

### 4. –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞

#### –û—Ç–∫—Ä—ã—Ç–∏–µ –∫–µ–π—Å–∞:

```typescript
async function openCase(userId: string, caseId: string) {
  // 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–∞–ª–∞–Ω—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ SmartShell
  const balance = await smartshellAPI.getBalance(userId);
  const caseData = await db.getCase(caseId);
  
  if (balance < caseData.price) {
    throw new Error('Insufficient balance');
  }
  
  // 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–µ–ø–æ–∑–∏—Ç
  const userDeposit = await smartshellAPI.getTotalDeposit(userId);
  if (userDeposit < caseData.deposit_min) {
    throw new Error('Minimum deposit required');
  }
  
  // 3. –°–ø–∏—Å–∞—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å –∫–µ–π—Å–∞
  await smartshellAPI.deductBalance(userId, caseData.price);
  
  // 4. –ü–æ–ª—É—á–∏—Ç—å –ø—Ä–µ–¥–º–µ—Ç—ã –∫–µ–π—Å–∞ —Å —à–∞–Ω—Å–∞–º–∏
  const items = await db.getCaseItems(caseId);
  
  // 5. –í–ê–ñ–ù–û: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (—á–µ—Å—Ç–Ω–∞—è)
  const wonItem = selectRandomItem(items);
  
  // 6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–æ–∫
  if (wonItem.type !== 'balance' && wonItem.stock <= 0) {
    // –ï—Å–ª–∏ —Å—Ç–æ–∫–∞ –Ω–µ—Ç, –≤—ã–¥–∞—Ç—å –¥—Ä—É–≥–æ–π –ø—Ä–µ–¥–º–µ—Ç –∏–ª–∏ –≤–µ—Ä–Ω—É—Ç—å –¥–µ–Ω—å–≥–∏
    await smartshellAPI.addBalance(userId, caseData.price);
    throw new Error('Item out of stock');
  }
  
  // 7. –ï—Å–ª–∏ –≤—ã–∏–≥—Ä–∞–Ω Balance Bonus
  if (wonItem.type === 'balance') {
    // –ù–∞—á–∏—Å–ª–∏—Ç—å –±–∞–ª–∞–Ω—Å
    await smartshellAPI.addBalance(userId, wonItem.balance_amount);
  } else {
    // –£–º–µ–Ω—å—à–∏—Ç—å —Å—Ç–æ–∫
    await db.decrementStock(wonItem.id);
  }
  
  // 8. –î–æ–±–∞–≤–∏—Ç—å –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å
  await db.addToInventory(userId, wonItem.id, caseId);
  
  // 9. –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ
  await db.createLog('case_opened', userId, caseId, wonItem.id);
  
  // 10. –î–æ–±–∞–≤–∏—Ç—å –≤ –ª–µ–Ω—Ç—É –∂–∏–≤—ã—Ö –¥—Ä–æ–ø–æ–≤
  await db.addLiveDrop(userId, wonItem.id, caseId);
  
  return {
    won_item: wonItem,
    animation_sequence: generateAnimationSequence(wonItem)
  };
}
```

#### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —á–µ—Å—Ç–Ω–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:

```typescript
function selectRandomItem(items: CaseItem[]): Item {
  // –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å —à–∞–Ω—Å—ã
  const totalChance = items.reduce((sum, item) => sum + item.drop_chance, 0);
  
  // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω–æ–≥–æ —á–∏—Å–ª–∞
  const random = Math.random() * totalChance;
  
  let accumulated = 0;
  for (const item of items) {
    accumulated += item.drop_chance;
    if (random <= accumulated) {
      return item;
    }
  }
  
  // Fallback
  return items[0];
}
```

#### –ó–∞—è–≤–∫–∞ –Ω–∞ –≤—ã–¥–∞—á—É:

```typescript
async function claimPrize(userId: string, inventoryItemId: string, data: ClaimData) {
  // 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø—Ä–µ–¥–º–µ—Ç –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ
  const inventoryItem = await db.getInventoryItem(inventoryItemId);
  
  if (inventoryItem.user_id !== userId) {
    throw new Error('Not your item');
  }
  
  if (inventoryItem.status !== 'in_inventory') {
    throw new Error('Item already claimed');
  }
  
  // 2. –°–æ–∑–¥–∞—Ç—å –∑–∞—è–≤–∫—É
  const request = await db.createPrizeRequest({
    user_id: userId,
    inventory_id: inventoryItemId,
    item_id: inventoryItem.item_id,
    phone: data.phone,
    nickname: data.nickname,
    comment: data.comment,
    status: 'pending'
  });
  
  // 3. –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ
  await db.updateInventoryStatus(inventoryItemId, 'claimed');
  
  // 4. –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å
  await db.createLog('prize_claimed', userId, inventoryItemId);
  
  return request;
}
```

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### JWT –¢–æ–∫–µ–Ω—ã

**–î–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤:**
```typescript
const token = jwt.sign(
  { user_id: user.id, type: 'client' },
  process.env.JWT_SECRET,
  { expiresIn: '7d' }
);
```

**–î–ª—è –∞–¥–º–∏–Ω–æ–≤:**
```typescript
const token = jwt.sign(
  { admin_id: admin.id, role: admin.role, type: 'admin' },
  process.env.ADMIN_JWT_SECRET,
  { expiresIn: '24h' }
);
```

### Middleware –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–æ–ª–µ–π:

```typescript
function requireRole(allowedRoles: AdminRole[]) {
  return (req, res, next) => {
    if (!allowedRoles.includes(req.admin.role)) {
      return res.status(403).json({ error: 'Forbidden' });
    }
    next();
  };
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
app.delete('/api/admin/users/:id', requireRole(['owner']), deleteUser);
```

---

## üìä –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Å—Ç–µ–∫ –¥–ª—è Backend

### –í–∞—Ä–∏–∞–Ω—Ç 1: Node.js + Express
```bash
npm install express cors helmet bcryptjs jsonwebtoken
npm install pg sequelize  # PostgreSQL
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: Python + FastAPI
```bash
pip install fastapi uvicorn sqlalchemy psycopg2-binary
pip install python-jose[cryptography] passlib[bcrypt]
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: PHP + Laravel
```bash
composer require laravel/framework
composer require tymon/jwt-auth
```

---

## üöÄ –î–µ–ø–ª–æ–π

### Backend
- API —Å–µ—Ä–≤–µ—Ä –Ω–∞ –ø–æ—Ä—Ç–µ 3000 (–∏–ª–∏ –¥—Ä—É–≥–æ–º)
- –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö PostgreSQL/MySQL
- Redis –¥–ª—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –ö–ª–∏–µ–Ω—Ç (Desktop)
- –°–æ–±—Ä–∞—Ç—å .exe —á–µ—Ä–µ–∑ Electron/Tauri
- –†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è—Ç—å —á–µ—Ä–µ–∑ SmartShell –∏–ª–∏ —Å–∞–π—Ç

### –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (Web)
- –î–µ–ø–ª–æ–π –Ω–∞ –¥–æ–º–µ–Ω: `admin.cyberhub.com`
- Nginx/Apache reverse proxy –∫ API

---

## ‚úÖ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã

### Phase 1 (MVP):
1. ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö + –º–∏–≥—Ä–∞—Ü–∏–∏
2. ‚úÖ API –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –∫–µ–π—Å–æ–≤
3. ‚úÖ API –¥–ª—è –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
4. ‚úÖ API –∞–¥–º–∏–Ω–∫–∏ (CRUD items/cases)
5. ‚úÖ SmartShell –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (–±–∞–ª–∞–Ω—Å)

### Phase 2:
6. ‚úÖ –ó–∞—è–≤–∫–∏ –Ω–∞ –≤—ã–¥–∞—á—É
7. ‚úÖ –°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–æ–≤
8. ‚úÖ –õ–µ–Ω—Ç–∞ –∂–∏–≤—ã—Ö –¥—Ä–æ–ø–æ–≤
9. ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ dashboard

### Phase 3:
10. ‚úÖ WebSocket –¥–ª—è live updates
11. ‚úÖ Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
12. ‚úÖ –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
13. ‚úÖ –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö

---

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- **Mock –¥–∞–Ω–Ω—ã–µ**: –°–µ–π—á–∞—Å –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ localStorage
- **–ù—É–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å**: –í—Å–µ –≤—ã–∑–æ–≤—ã localStorage –Ω–∞ API –∑–∞–ø—Ä–æ—Å—ã
- **–ß–µ—Å—Ç–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è**: –û—Ç–∫—Ä—ã—Ç–∏–µ –∫–µ–π—Å–∞ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- **–°—Ç–æ–∫–∏**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏
- **–õ–æ–≥–∏**: –í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –¥–ª—è –∞—É–¥–∏—Ç–∞

---

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã

–ü—Ä–∏ –≤–æ–ø—Ä–æ—Å–∞—Ö:
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `/DEPLOYMENT_GUIDE.md`
- –ò–∑—É—á–∏—Ç–µ `/ADMIN_README.md`
- –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –∫–æ–¥ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

**–£–¥–∞—á–∏ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ! üöÄ**
